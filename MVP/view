#!/usr/bin/env groovy
import groovy.io.FileType
import javax.swing.*
import java.awt.event.KeyAdapter
import java.awt.event.KeyEvent

String home() { System.properties['user.home'] }
String recordings() { home() +'/recordings' }

List<File> existingImages() {
    def list = []
    def dir = new File(recordings())
    dir.eachFileRecurse (FileType.FILES) { file ->
        String name = file.name
        if (name.endsWith('.png') && !name.startsWith("Screen Shot")) {
            list << file
        }
    }
    list
}

class Viewer {
    int x = 0
    int y = 0
    List<File> files
    Viewer(List<File> files) {
        this.files = files
    }

    void up() {
        if (y>0) y = y - 1
    }

    void down() {
        if (y<files.size()-1) y = y + 1
    }

    void left() {
        if (x>0) x = x - 1
    }

    void right() {
        x = x + 1
    }

    void showImages() {
        JFrame frame = new JFrame("Recordings")
        frame.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE)
        frame.setSize(500,500)
        frame.addKeyListener(new KeyAdapter() {
            @Override void keyPressed(KeyEvent e) {
                int code = e.keyCode
                if (code==KeyEvent.VK_UP)       up()
                if (code==KeyEvent.VK_DOWN)   down()
                if (code==KeyEvent.VK_LEFT)   left()
                if (code==KeyEvent.VK_RIGHT) right()
                println "($x , $y) ${files.get(y)}"
            }
        })
        frame.setVisible(true)
    }
}

if (args.length == 0) {
    Viewer viewer = new Viewer(existingImages())
    viewer.showImages()
} else {
    existingImages().forEach(f -> println f)
}
println 'done'
